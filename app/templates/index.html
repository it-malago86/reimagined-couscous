<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}"> 
    <title>Meine Kids | Online Shop</title>
</head>
<body>

    <header class="navbar">
        <div class="logo">Meine Kids</div>
        <nav class="nav-links">
            <a href="javascript:void(0)" onclick="showSection('shop')">Catalogo Online</a>
            <a href="javascript:void(0)" onclick="showSection('about')">Chi Sono</a>
        </nav>
    </header>

    <main id="shop" class="section">
        <div class="grid">
            {% for p in products %}
	  <div class="card"> <img src="{{ p.image }}" alt="{{ p.name }}" class="product-img">
	      <div class="product-info">
	          <h3>{{ p.name }}</h3>
	          <p>{{ p.desc }}</p>
	          <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">
	              <span class="price">€{{ p.price }}</span>
	              <button class="btn-add" onclick="event.stopPropagation(); addToCart('{{ p.name }}', {{ p.price }})">
	                  ＋ Aggiungi
	              </button>
	          </div>
	      </div>
	  </div>
	 <div class="add-icon">＋</div>
	 <div id="cart-section" style="display:none; position: fixed; bottom: 20px; right: 20px; width: 320px; background: white; border-radius: 15px; padding: 1.5rem; box-shadow: 0 10px 25px rgba(0,0,0,0.15); border: 1px solid #e5e7eb; z-index: 1000;">
   		 <h4 style="margin-top:0;">Il tuo ordine</h4>
   		 <div id="cart-items" style="max-height: 200px; overflow-y: auto; margin-bottom: 15px;">
       			 </div>
	 <div style="border-top: 1px solid #eee; padding-top: 10px; margin-bottom: 15px;">
       		 <strong>Totale: €<span id="total-price">0</span></strong>
   	 </div>
    
    <input type="text" id="custName" placeholder="Tuo Nome" style="width:100%; padding: 8px; margin-bottom: 8px; border: 1px solid #ddd; border-radius: 5px;">
    <input type="text" id="custAddress" placeholder="Indirizzo di consegna" style="width:100%; padding: 8px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 5px;">
    
    <button onclick="finalizeOrder()" style="width:100%; background:#25D366; color:white; border:none; padding:12px; border-radius:8px; font-weight:bold; cursor:pointer;">
        Invia Ordine su WhatsApp
    </button>
</div>
            {% endfor %}
        </div>
    </main>

    <section id="about" class="section" style="display:none;">
        <div class="about-container" style="display: flex; flex-wrap: wrap; gap: 30px; align-items: center; padding: 20px;">
            <div style="flex: 1; min-width: 300px;">
                <img src="/static/images/artigiano-al-lavoro.jpg" style="width: 100%; border-radius: 30px; box-shadow: 10px 10px 0px #e2eadd;">
            </div>
            <div style="flex: 1; min-width: 300px;">
                <h2 style="color: #7c9473;">Dietro ogni creazione...</h2>
                <p>Siamo una piccola bottega nata dal desiderio di riportare la materia al centro della vita quotidiana.</p>
                <p>Ogni pezzo richiede ore di lavoro e una cura meticolosa per i dettagli.</p>
            </div>
        </div>
    </section>

   <div id="cart-section" style="display:none; position: fixed; bottom: 20px; right: 20px; width: 320px; background: white; border-radius: 15px; padding: 1.5rem; box-shadow: 0 10px 25px rgba(0,0,0,0.15); border: 1px solid #e5e7eb; z-index: 1000;">
    <h4 style="margin-top:0;">Il tuo ordine</h4>
    <div id="cart-items" style="max-height: 200px; overflow-y: auto; margin-bottom: 15px;">
        </div>
    <div style="border-top: 1px solid #eee; padding-top: 10px; margin-bottom: 15px;">
        <strong>Totale: €<span id="total-price">0</span></strong>
    </div>
    
    <input type="text" id="custName" placeholder="Tuo Nome" style="width:100%; padding: 8px; margin-bottom: 8px; border: 1px solid #ddd; border-radius: 5px;">
    <input type="text" id="custAddress" placeholder="Indirizzo di consegna" style="width:100%; padding: 8px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 5px;">
    
    <button onclick="finalizeOrder()" style="width:100%; background:#25D366; color:white; border:none; padding:12px; border-radius:8px; font-weight:bold; cursor:pointer;">
        Invia Ordine su WhatsApp
    </button>
</div>
<script>
    window.cart = [];

    window.addToCart = function(name, price) {
        console.log("Aggiungendo:", name, price); // Questo serve per il debug
        window.cart.push({ name: name, price: price });
        
        // Mostra il carrello
        const cartSection = document.getElementById('cart-section');
        cartSection.style.display = 'block';
        
        updateUI();
    };

    function updateUI() {
        const list = document.getElementById('cart-items');
        list.innerHTML = window.cart.map(item => `
            <div style="display:flex; justify-content:space-between; margin-bottom:5px; border-bottom:1px solid #eee;">
                <span>${item.name}</span>
                <span>€${item.price}</span>
            </div>
        `).join('');

        const total = window.cart.reduce((sum, item) => sum + item.price, 0);
        document.getElementById('total-price').innerText = total;
    }

    window.finalizeOrder = function() {
        const name = document.getElementById('custName').value;
        const addr = document.getElementById('custAddress').value;

        if(!name || !addr) {
            alert("Inserisci nome e indirizzo per procedere!");
            return;
        }

        const items = window.cart.map(i => `- ${i.name} (€${i.price})`).join('%0A');
        const total = document.getElementById('total-price').innerText;
        const text = `Ciao! Vorrei ordinare:%0A${items}%0A%0ATotale: €${total}%0A%0ANome: ${name}%0AIndirizzo: ${addr}`;
        
        // Apre WhatsApp in una nuova scheda
        window.open(`https://wa.me/{{ phone }}?text=${text}`);
    };
</script>
    	
    	    
</body>
</html>

